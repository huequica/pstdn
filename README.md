# pstdn
ポストドン。スクリプト経由でmastodonに文字列トゥートできます(るび〜処女作)  
![Desktop](https://media.mstdn.jp/images/media_attachments/files/007/476/557/original/cf10b3c1b6a3f595.png)

# なにこれ？
察して下さい  

# できること、できないこと
あくまで文字トゥートができればそれでよかったのでそれ以外実装していません  
画像トゥートできるようにもしたいけどやる気次第です  
また自分の技術力不足、及び例外を一切考慮していない雑な設計のため不具合が絶対出ます  
その時はIssuesか hilite_menthol@mstdn.jp に報告してください  
ただしこれもやる気次第なのでやらないかもしれない。ごめんね  

# 必須gem
・http API叩くのに使ってます。Macであれば大抵初期から入ってますがなければ入れてください  
```Bash
$ gem list | grep "http"
```
このコマンドで入ってるか確認ができます。  
# 下準備
分かる人には3行で説明できます  
・アクセストークン取って、'MASTODON_ACCESS_TOKEN'の名前で環境変数つくる(面倒だったらスクリプト内部のローカル変数に書き換えるなり好きにしてください)  
```Bash
$ export MASTODON_ACCESS_TOKEN='INSERT ACCESS_TOKEN TO HERE'
```
・インスタンス変えたければスクリプトの中の'MASTODON_HOST'の変数の中身を書き換えて下さい。デフォは https://mstdn.jp です  
```ruby
MASTODON_HOST = 'https://mstdn.jp'
#この中身変えればインスタンス変更できます。サポートはしませんがご自由にどうぞ
```

・コマンドライン上で実行してやって下さい、ただし常駐するので1回だけトゥートして消える感じの方には向きません  

わからない人にはブログかどっかでもうちょっと手とり足取りちゃんと書くのでお待ち下さい

# つかいかた
## 基本
基本的にはトゥートしたい文面を打ち込んで改行したのち、Ctrl+Dを叩くことでトゥートされます。  
ただし以下のオプションが存在します。
## 1行目のみ有効のオプション
```
!CW [CWに挿入する文章]
```
1行目の行頭からこのように記述することでCWをつけることができます。  
1行目の行頭以外で書くと無視されますので注意してください。
```
exit
```
exitと入力してCtrl+Dをすると終了します。
## どこでも有効のオプション<br>
```
〜〜〜!Clear
```
入力しているトゥート文面を消します。誤字ったときなどにどうぞ。

```
!visiv
```
!visivと入れるとトゥート処理直前に公開範囲を聞いてきます。行頭以外で書くと無視しますので注意してください。

# 注意事項
プロキシを通していると一生待機状態のまま動かない状態に陥ります。  
gemのネットワーク設定が自動のままであることが原因っぽいので、その場合はお手数ですが環境変数を追加で2つ設定してください。

```Bash
$ export http_proxy='ADDRESS:PORT NUMBER'
$ export https_proxy='ADDRESS:PORT NUMBER'
```

# 更新履歴
2018/09/27 (Thu) Ver0.71 公開範囲設定の際キャンセルができるように変更

2018/09/06 (Thr) Ver0.70 公開範囲設定を実装、正規表現まわりの仕様を変更  

2018/08/26 (Sun) Ver0.66 謎のエラーを無理やり消していたけど原因が判明したので該当部分を修正  

2018/08/24 (Fri) Ver0.65 curlを解雇してhttpから直接叩く方式に変更、トゥートの結果表示を再度実装  

2018/08/22 (Wen) Ver0.60 CW実装、およびmastodon-apiを使用しない方向に変更  

2018/08/16 (Thu) Ver0.57 何も入力されていない状態でCtrl+Dを押すとエラーで強制停止する問題を修正  

2018/06/14 (Thu) Ver0.55 出力の際の一部メソッド、及び出力の際のソース変更  

起動の際にログインしているインスタンスを表示するように  

2018/06/09 (Fri) Ver0.53 トゥート文面キャンセルを兼ねたコマンドラインを掃除する機能(!Clearのやつ)実装  

2018/06/07 (Thu) 初版公開、ver0.50とでもしておきます